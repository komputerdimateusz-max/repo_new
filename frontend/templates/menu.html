{% extends "base.html" %}

{% block title %}repo_new | {{ t('dashboard.today_menu', lang) }}{% endblock %}

{% block content %}
<div class="page-container">
  <header class="page-header">
    <div>
      <h1 class="page-title">{{ t('dashboard.today_menu', lang) }}{% if selected_restaurant %} – {{ selected_restaurant.name }}{% endif %}</h1>
      <p class="page-subtitle">{{ t('menu.page_lead', lang) }}</p>
    </div>
    {% if current_user %}
    <span class="pill pill--accent">{% if current_user.role == 'customer' %}Customer{% elif current_user.role == 'restaurant' %}Restaurant{% else %}Administrator{% endif %}</span>
    {% endif %}
  </header>

  <section class="form-card" aria-label="Today's menu items">
    {% if current_user and current_user.role != 'restaurant' and restaurants %}
    <form method="get" action="/menu" class="stack-sm">
      <label class="field">
        <span>Restauracja</span>
        <select name="restaurant_id" onchange="this.form.submit()">
          {% for restaurant in restaurants %}
          <option value="{{ restaurant.id }}" {% if selected_restaurant_id == restaurant.id %}selected{% endif %}>{{ restaurant.name }}</option>
          {% endfor %}
        </select>
      </label>
      <label>
        <input type="checkbox" name="show_open_only" value="1" {% if show_open_only %}checked{% endif %} onchange="this.form.submit()">
        Tylko otwarte
      </label>
    </form>
    {% endif %}

    {% if menu_items %}
    <div class="stack-md">
      {% for item in menu_items %}
      <div>
        <strong>{{ item.name }}</strong>
        {% if item.description %}
        <p>{{ item.description }}</p>
        {% endif %}
        <p>{{ '%.2f'|format(item.price_cents / 100) }} PLN</p>
      </div>
      {% endfor %}
    </div>
    <a href="/order?restaurant_id={{ selected_restaurant.id if selected_restaurant else '' }}" class="btn btn--primary">{{ t('dashboard.place_order', lang) }}</a>
    {% else %}
    <p>Brak opublikowanego menu na dziś dla tej restauracji.</p>
    {% endif %}
  </section>
</div>
{% endblock %}
