{% extends "base.html" %}

{% block title %}{{ t('settings.title', lang) }} Â· repo_new{% endblock %}

{% block content %}
<div class="page-container">
  <header class="page-header">
    <div>
      <h1 class="page-title">{{ t('settings.title', lang) }}</h1>
      <p class="page-subtitle">Manage user roles and restaurant assignments.</p>
    </div>
    <span class="pill pill--accent">Administrator</span>
  </header>

  {% if message %}
  <p class="alert alert-success" role="status">{{ message }}</p>
  {% endif %}

  <section class="section">
    <h2 class="section-title">{{ t('settings.user_roles', lang) }}</h2>
    <div class="form-card table-wrap">
      <table class="simple-table">
        <thead>
          <tr>
            <th>{{ t('settings.column_id', lang) }}</th>
            <th>{{ t('settings.column_email', lang) }}</th>
            <th>{{ t('settings.column_role', lang) }}</th>
            <th>Restaurant</th>
            <th>{{ t('settings.column_action', lang) }}</th>
          </tr>
        </thead>
        <tbody>
          {% for user in users %}
          <tr>
            <form method="post" action="/settings/users/{{ user.id }}/role">
              <td>{{ user.id }}</td>
              <td>{{ user.email }}</td>
              <td>
                <select class="input" name="role" aria-label="{{ t('settings.column_role', lang) }}">
                  {% for role in ['customer', 'restaurant', 'admin'] %}
                  <option value="{{ role }}" {% if user.role == role %}selected{% endif %}>{{ t('role.' ~ role, lang) }}</option>
                  {% endfor %}
                </select>
              </td>
              <td>
                <select class="input" name="restaurant_id">
                  <option value="">-</option>
                  {% for restaurant in restaurants %}
                  <option value="{{ restaurant.id }}" {% if user.restaurant_id == restaurant.id %}selected{% endif %}>{{ restaurant.name }}</option>
                  {% endfor %}
                </select>
              </td>
              <td><button type="submit" class="btn btn--secondary btn-inline">{{ t('settings.save', lang) }}</button></td>
            </form>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </section>
</div>
{% endblock %}
