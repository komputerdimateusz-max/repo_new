"""Simple translation helpers for server-rendered templates."""

from fastapi import Request

SUPPORTED_LANGUAGES: set[str] = {"en", "pl"}
DEFAULT_LANGUAGE: str = "en"

TRANSLATIONS: dict[str, dict[str, str]] = {
    "en": {
        "nav.home": "Home",
        "nav.login": "Log in",
        "nav.register": "Register",
        "nav.app": "Dashboard",
        "nav.logout": "Log out",
        "nav.catering": "Catering",
        "nav.settings": "Settings",
        "index.eyebrow": "Meal ordering platform",
        "index.lead": "A simple and mobile-first meal ordering experience for employees and companies.",
        "index.login": "Log in",
        "index.docs": "View API Docs",
        "login.title": "Sign in",
        "login.lead": "Use your account to continue to your dashboard.",
        "login.email": "Email",
        "login.password": "Password",
        "login.submit": "Sign in",
        "login.create_account": "Create account",
        "back.home": "Back to Home",
        "register.title": "Create account",
        "register.lead": "Create a new account to access the meal ordering dashboard.",
        "register.role": "Role",
        "register.submit": "Create account",
        "back.login": "Back to Login",
        "role.customer": "Customer",
        "role.restaurant": "Restaurant",
        "role.admin": "Admin",
        "dashboard.title": "Dashboard",
        "dashboard.lead": "Place today's order and review your current selection.",
        "dashboard.user_actions_label": "User actions",
        "dashboard.today_menu": "Today's Menu",
        "dashboard.place_order_tile": "Place an Order",
        "dashboard.place_order_description": "Quickly pick quantities from today's menu and submit your order.",
        "dashboard.no_menu": "No menu items are available for today.",
        "dashboard.quantity": "Quantity",
        "dashboard.place_order": "Place order",
        "dashboard.my_orders": "My Orders",
        "dashboard.card_orders_description": "Review your order summary for the selected day.",
        "dashboard.no_orders": "You have no order for today.",
        "dashboard.card_menu_description": "Browse today's dishes and submit your order.",
        "dashboard.admin_tools": "Admin tools",
        "dashboard.add_today_menu": "Add Today's Menu",
        "dashboard.add_today_menu_description": "Manage dishes for a selected day in catering panel.",
        "dashboard.supported_locations": "Supported Locations",
        "dashboard.supported_locations_description": "Manage company locations and delivery addresses.",
        "dashboard.ordering_opening_hours": "Ordering Opening Hours",
        "dashboard.ordering_opening_hours_description": "Set the time window when users are allowed to place orders.",
        "dashboard.catering_orders": "Orders",
        "dashboard.catering_orders_description": "Review all user orders for a selected date.",
        "dashboard.total": "Total",
        "dashboard.company_billing": "Company Billing",
        "dashboard.billing_placeholder": "Billing summaries and payment details will be available here.",
        "menu.page_lead": "Browse today's available dishes and place your order.",
        "orders.page_lead": "Review your submitted order for today.",
        "order.page_title": "Place an Order",
        "order.page_lead": "Select quantities from today's menu and submit your order.",
        "order.form_aria": "Order form",
        "order.select_location": "Select location",
        "order.select_location_placeholder": "Select location",
        "order.error.location_required": "Please select a supported location.",
        "order.cutoff_prompt": "The cut-off time for this location has passed. Do you want to place the order for the next day?",
        "order.next_day_confirm": "Order for tomorrow",
        "order.next_day_cancel": "Cancel",
        "order.error.invalid_date": "Selected date is outside allowed horizon.",
        "orders.selected_date": "Date",
        "orders.show_tomorrow": "Show tomorrow's order",
        "billing.page_lead": "This section will include invoices and settlement details.",
        "order.updated": "Your order has been updated.",
        "error.invalid_credentials": "Invalid credentials",
        "error.invalid_role": "Invalid role selection.",
        "error.email_registered": "Email already registered.",
        "register.success": "Account created, you can sign in now.",
        "menu.title": "Manage Today's Menu",
        "menu.subtitle": "Create and manage today's menu items",
        "menu.select_date": "Select date",
        "menu.date": "Date",
        "menu.load_date": "Load menu",
        "menu.add_item": "Add menu item",
        "menu.name": "Name",
        "menu.description": "Description",
        "menu.price": "Price (PLN)",
        "menu.active": "Active",
        "menu.standard": "Standard dish",
        "menu.add_button": "Add item",
        "menu.items_for_day": "Today's menu items",
        "menu.catalog_items": "Catalog dishes",
        "menu.enabled_today": "Enabled today",
        "menu.not_enabled_today": "Not enabled today",
        "menu.enable_today": "Enable for today",
        "menu.disable_today": "Disable for today",
        "menu.status_active": "Active",
        "menu.status_inactive": "Inactive",
        "menu.disable": "Disable",
        "menu.enable": "Enable",
        "menu.empty": "No menu items for today.",
        "order.empty_for_date": "Menu not published for this day.",
        "weekly_menu.title": "Weekly menu",
        "weekly_menu.lead": "Schedule menu items per date for the next 7 days.",
        "weekly_menu.add_item": "Add item to this date",
        "weekly_menu.select_catalog": "Select catalog item",
        "weekly_menu.enable_standard": "Enable standard dishes for this date",
        "weekly_menu.copy_from_date": "Copy from another date",
        "weekly_menu.items_for_date": "Menu for selected date:",
        "weekly_menu.remove": "Remove",
        "menu.success.created": "Menu item created.",
        "menu.error.forbidden": "You are not allowed to access catering menu.",
        "menu.error.name_required": "Name is required.",
        "menu.error.invalid_price": "Please provide a valid positive price.",
        "catering_orders.title": "Orders",
        "catering_orders.lead": "Review all submitted orders for the selected date.",
        "catering_orders.table_title": "Daily orders",
        "catering_orders.column_order_id": "Order ID",
        "catering_orders.column_user_email": "User email",
        "catering_orders.column_items": "Items",
        "catering_orders.column_total": "Total",
        "catering_orders.empty": "No orders for selected date.",
        "catering_orders.summary_title": "Summary by location",
        "catering_orders.summary_orders_count": "Orders",
        "catering_orders.summary_items_count": "Items",
        "catering_orders.summary_total": "Total",
        "settings.title": "Settings",
        "settings.user_roles": "User roles",
        "settings.column_id": "ID",
        "settings.column_email": "Email",
        "settings.column_role": "Role",
        "settings.column_action": "Action",
        "settings.save": "Save",
        "settings.success.role_updated": "User role updated.",
        "settings.error.forbidden": "You are not allowed to access settings.",
        "settings.error.invalid_role": "Invalid role selection.",
        "settings.error.user_not_found": "User not found.",
        "settings.dev.admin_exists": "Admin user already exists.",
        "settings.dev.promoted": "User promoted to admin.",
        "locations.title": "Supported Locations",
        "locations.lead": "Manage company locations and delivery addresses.",
        "locations.add_form_title": "Add location",
        "locations.company_name": "Company name",
        "locations.address": "Address",
        "locations.delivery_hours": "Default delivery hours (optional)",
        "locations.delivery_start": "Start time",
        "locations.delivery_end": "End time",
        "locations.cutoff_time": "Cut-off time",
        "locations.active": "Active",
        "locations.add_button": "Add location",
        "locations.list_title": "Supported locations",
        "locations.hours_not_set": "Not set",
        "locations.status": "Status",
        "locations.empty": "No locations created yet.",
        "locations.success.created": "Location created.",
        "locations.error.required_fields": "Company name and address are required.",
        "locations.error.invalid_time": "Invalid delivery time format.",
        "opening_hours.title": "Ordering Opening Hours",
        "opening_hours.description": "Set the time window when users are allowed to place orders.",
        "opening_hours.open_time": "Opening time",
        "opening_hours.close_time": "Closing time",
        "opening_hours.save": "Save",
        "opening_hours.current_window": "Current ordering window: {open_time} - {close_time}",
        "opening_hours.success.saved": "Ordering opening hours saved.",
        "opening_hours.error.invalid_time": "Invalid time format.",
        "opening_hours.error.invalid_window": "Opening time must be earlier than closing time.",
        "order.opening_hours.title": "Ordering hours",
        "order.opening_hours.closed": "Ordering is currently closed.",
        "order.opening_hours.window": "Orders can be placed between {open_time} and {close_time}.",
        "order.opening_hours.next_open": "Next opening time: {time}.",
        "order.opening_hours.form_disabled": "Order form is disabled outside ordering hours.",
    },
    "pl": {
        "nav.home": "Strona główna",
        "nav.login": "Zaloguj się",
        "nav.register": "Rejestracja",
        "nav.app": "Panel",
        "nav.logout": "Wyloguj",
        "nav.catering": "Catering",
        "nav.settings": "Ustawienia",
        "index.eyebrow": "Platforma zamawiania posiłków",
        "index.lead": "Proste i mobilne zamawianie posiłków dla pracowników i firm.",
        "index.login": "Zaloguj się",
        "index.docs": "Dokumentacja API",
        "login.title": "Logowanie",
        "login.lead": "Użyj konta, aby przejść do panelu.",
        "login.email": "E-mail",
        "login.password": "Hasło",
        "login.submit": "Zaloguj się",
        "login.create_account": "Utwórz konto",
        "back.home": "Wróć do strony głównej",
        "register.title": "Utwórz konto",
        "register.lead": "Utwórz nowe konto, aby korzystać z panelu zamówień.",
        "register.role": "Rola",
        "register.submit": "Utwórz konto",
        "back.login": "Wróć do logowania",
        "role.customer": "Klient",
        "role.restaurant": "Restauracja",
        "role.admin": "Administrator",
        "dashboard.title": "Panel",
        "dashboard.lead": "Złóż dzisiejsze zamówienie i sprawdź bieżący wybór.",
        "dashboard.user_actions_label": "Akcje użytkownika",
        "dashboard.today_menu": "Dzisiejsze menu",
        "dashboard.place_order_tile": "Złóż zamówienie",
        "dashboard.place_order_description": "Wybierz ilości z dzisiejszego menu i wyślij zamówienie.",
        "dashboard.no_menu": "Brak pozycji w menu na dziś.",
        "dashboard.quantity": "Ilość",
        "dashboard.place_order": "Złóż zamówienie",
        "dashboard.my_orders": "Moje zamówienia",
        "dashboard.card_orders_description": "Sprawdź podsumowanie zamówienia dla wybranego dnia.",
        "dashboard.no_orders": "Nie masz zamówienia na dziś.",
        "dashboard.card_menu_description": "Przeglądaj dzisiejsze dania i złóż zamówienie.",
        "dashboard.admin_tools": "Narzędzia administratora",
        "dashboard.add_today_menu": "Dodaj menu na dziś",
        "dashboard.add_today_menu_description": "Zarządzaj daniami dla wybranego dnia w panelu cateringu.",
        "dashboard.supported_locations": "Lista obsługiwanych lokalizacji",
        "dashboard.supported_locations_description": "Zarządzaj firmami i adresami dostawy.",
        "dashboard.ordering_opening_hours": "Godziny otwarcia zamówień",
        "dashboard.ordering_opening_hours_description": "Ustaw okno czasowe, w którym użytkownicy mogą składać zamówienia.",
        "dashboard.catering_orders": "Zamówienia",
        "dashboard.catering_orders_description": "Przeglądaj wszystkie zamówienia użytkowników dla wybranej daty.",
        "dashboard.total": "Suma",
        "dashboard.company_billing": "Rozliczenia firmy",
        "dashboard.billing_placeholder": "Podsumowania rozliczeń i szczegóły płatności będą dostępne tutaj.",
        "menu.page_lead": "Przeglądaj dzisiejsze dostępne dania i złóż zamówienie.",
        "orders.page_lead": "Sprawdź złożone zamówienie na dziś.",
        "order.page_title": "Złóż zamówienie",
        "order.page_lead": "Wybierz ilości z dzisiejszego menu i wyślij zamówienie.",
        "order.form_aria": "Formularz zamówienia",
        "order.select_location": "Wybierz lokalizację",
        "order.select_location_placeholder": "Wybierz lokalizację",
        "order.error.location_required": "Wybierz obsługiwaną lokalizację.",
        "order.cutoff_prompt": "Minęła godzina cut-off dla tej lokalizacji. Czy chcesz złożyć zamówienie na jutro?",
        "order.next_day_confirm": "Zamów na jutro",
        "order.next_day_cancel": "Anuluj",
        "order.error.invalid_date": "Wybrana data jest poza dozwolonym zakresem.",
        "orders.selected_date": "Data",
        "orders.show_tomorrow": "Pokaż zamówienie na jutro",
        "billing.page_lead": "W tej sekcji pojawią się faktury i szczegóły rozliczeń.",
        "order.updated": "Twoje zamówienie zostało zaktualizowane.",
        "error.invalid_credentials": "Nieprawidłowe dane logowania",
        "error.invalid_role": "Nieprawidłowa rola.",
        "error.email_registered": "E-mail jest już zarejestrowany.",
        "register.success": "Konto utworzone, możesz się zalogować.",
        "menu.title": "Zarządzanie menu na dziś",
        "menu.subtitle": "Twórz i zarządzaj dzisiejszymi pozycjami menu",
        "menu.select_date": "Wybierz datę",
        "menu.date": "Data",
        "menu.load_date": "Wczytaj menu",
        "menu.add_item": "Dodaj pozycję menu",
        "menu.name": "Nazwa",
        "menu.description": "Opis",
        "menu.price": "Cena (PLN)",
        "menu.active": "Aktywna",
        "menu.standard": "Danie standardowe",
        "menu.add_button": "Dodaj pozycję",
        "menu.items_for_day": "Dzisiejsze pozycje menu",
        "menu.catalog_items": "Dania z katalogu",
        "menu.enabled_today": "Włączone na dziś",
        "menu.not_enabled_today": "Niewłączone na dziś",
        "menu.enable_today": "Włącz na dziś",
        "menu.disable_today": "Wyłącz na dziś",
        "menu.status_active": "Aktywna",
        "menu.status_inactive": "Nieaktywna",
        "menu.disable": "Wyłącz",
        "menu.enable": "Włącz",
        "menu.empty": "Brak pozycji menu na dziś.",
        "order.empty_for_date": "Menu nie zostało opublikowane na ten dzień.",
        "weekly_menu.title": "Menu tygodniowe",
        "weekly_menu.lead": "Planuj pozycje menu na kolejne 7 dni.",
        "weekly_menu.add_item": "Dodaj pozycję na ten dzień",
        "weekly_menu.select_catalog": "Wybierz pozycję z katalogu",
        "weekly_menu.enable_standard": "Włącz dania standardowe na ten dzień",
        "weekly_menu.copy_from_date": "Skopiuj z innej daty",
        "weekly_menu.items_for_date": "Menu dla wybranej daty:",
        "weekly_menu.remove": "Usuń",
        "menu.success.created": "Pozycja menu została utworzona.",
        "menu.error.forbidden": "Nie masz dostępu do menu cateringu.",
        "menu.error.name_required": "Nazwa jest wymagana.",
        "menu.error.invalid_price": "Podaj poprawną dodatnią cenę.",
        "catering_orders.title": "Zamówienia",
        "catering_orders.lead": "Przeglądaj wszystkie złożone zamówienia dla wybranej daty.",
        "catering_orders.table_title": "Zamówienia dzienne",
        "catering_orders.column_order_id": "ID zamówienia",
        "catering_orders.column_user_email": "E-mail użytkownika",
        "catering_orders.column_items": "Liczba pozycji",
        "catering_orders.column_total": "Suma",
        "catering_orders.empty": "Brak zamówień dla wybranej daty.",
        "catering_orders.summary_title": "Podsumowanie wg lokalizacji",
        "catering_orders.summary_orders_count": "Liczba zamówień",
        "catering_orders.summary_items_count": "Liczba pozycji",
        "catering_orders.summary_total": "Suma",
        "settings.title": "Ustawienia",
        "settings.user_roles": "Role użytkowników",
        "settings.column_id": "ID",
        "settings.column_email": "E-mail",
        "settings.column_role": "Rola",
        "settings.column_action": "Akcja",
        "settings.save": "Zapisz",
        "settings.success.role_updated": "Rola użytkownika została zaktualizowana.",
        "settings.error.forbidden": "Nie masz dostępu do ustawień.",
        "settings.error.invalid_role": "Nieprawidłowa rola.",
        "settings.error.user_not_found": "Nie znaleziono użytkownika.",
        "settings.dev.admin_exists": "Użytkownik administrator już istnieje.",
        "settings.dev.promoted": "Użytkownik został awansowany na administratora.",
        "locations.title": "Lista obsługiwanych lokalizacji",
        "locations.lead": "Zarządzaj firmami i adresami dostawy.",
        "locations.add_form_title": "Dodaj lokalizację",
        "locations.company_name": "Nazwa firmy",
        "locations.address": "Adres",
        "locations.delivery_hours": "Standardowe godziny dostawy (opcjonalne)",
        "locations.delivery_start": "Godzina od",
        "locations.delivery_end": "Godzina do",
        "locations.cutoff_time": "Godzina cut-off",
        "locations.active": "Aktywna",
        "locations.add_button": "Dodaj lokalizację",
        "locations.list_title": "Obsługiwane lokalizacje",
        "locations.hours_not_set": "Nie ustawiono",
        "locations.status": "Status",
        "locations.empty": "Brak zdefiniowanych lokalizacji.",
        "locations.success.created": "Lokalizacja została dodana.",
        "locations.error.required_fields": "Nazwa firmy i adres są wymagane.",
        "locations.error.invalid_time": "Nieprawidłowy format godzin dostawy.",
        "opening_hours.title": "Godziny otwarcia zamówień",
        "opening_hours.description": "Ustaw okno czasowe, w którym użytkownicy mogą składać zamówienia.",
        "opening_hours.open_time": "Godzina otwarcia",
        "opening_hours.close_time": "Godzina zamknięcia",
        "opening_hours.save": "Zapisz",
        "opening_hours.current_window": "Aktualne okno zamówień: {open_time} - {close_time}",
        "opening_hours.success.saved": "Godziny otwarcia zamówień zapisane.",
        "opening_hours.error.invalid_time": "Nieprawidłowy format czasu.",
        "opening_hours.error.invalid_window": "Godzina otwarcia musi być wcześniejsza niż godzina zamknięcia.",
        "order.opening_hours.title": "Godziny zamówień",
        "order.opening_hours.closed": "Składanie zamówień jest obecnie zamknięte.",
        "order.opening_hours.window": "Zamówienia można składać między {open_time} a {close_time}.",
        "order.opening_hours.next_open": "Następne otwarcie: {time}.",
        "order.opening_hours.form_disabled": "Formularz zamówienia jest wyłączony poza godzinami zamówień.",
    },
}


def get_language(request: Request) -> str:
    """Resolve language code from cookie, fallback to default language."""
    lang: str = request.cookies.get("lang", DEFAULT_LANGUAGE)
    if lang not in SUPPORTED_LANGUAGES:
        return DEFAULT_LANGUAGE
    return lang


def t(key: str, lang: str) -> str:
    """Translate key for a specific language with safe fallback."""
    normalized_lang: str = lang if lang in SUPPORTED_LANGUAGES else DEFAULT_LANGUAGE
    return TRANSLATIONS.get(normalized_lang, {}).get(key, key)
