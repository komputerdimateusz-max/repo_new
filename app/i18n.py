"""Simple translation helpers for server-rendered templates."""

from fastapi import Request

SUPPORTED_LANGUAGES: set[str] = {"en", "pl"}
DEFAULT_LANGUAGE: str = "en"

TRANSLATIONS: dict[str, dict[str, str]] = {
    "en": {
        "nav.home": "Home",
        "nav.login": "Log in",
        "nav.register": "Register",
        "nav.app": "Dashboard",
        "nav.catering": "Catering",
        "nav.settings": "Settings",
        "index.eyebrow": "Meal ordering platform",
        "index.lead": "A simple and mobile-first meal ordering experience for employees and companies.",
        "index.login": "Log in",
        "index.docs": "View API Docs",
        "login.title": "Sign in",
        "login.lead": "Use your account to continue to your dashboard.",
        "login.email": "Email",
        "login.password": "Password",
        "login.submit": "Sign in",
        "login.create_account": "Create account",
        "back.home": "Back to Home",
        "register.title": "Create account",
        "register.lead": "Create a new account to access the meal ordering dashboard.",
        "register.role": "Role",
        "register.submit": "Create account",
        "back.login": "Back to Login",
        "role.employee": "Employee",
        "role.company": "Company",
        "role.catering": "Catering",
        "role.admin": "Admin",
        "dashboard.title": "Dashboard",
        "dashboard.lead": "Place today's order and review your current selection.",
        "dashboard.user_actions_label": "User actions",
        "dashboard.today_menu": "Today's Menu",
        "dashboard.place_order_tile": "Place an Order",
        "dashboard.place_order_description": "Quickly pick quantities from today's menu and submit your order.",
        "dashboard.no_menu": "No menu items are available for today.",
        "dashboard.quantity": "Quantity",
        "dashboard.place_order": "Place order",
        "dashboard.my_orders": "My Orders",
        "dashboard.card_orders_description": "Review your order summary for the selected day.",
        "dashboard.no_orders": "You have no order for today.",
        "dashboard.card_menu_description": "Browse today's dishes and submit your order.",
        "dashboard.admin_tools": "Admin tools",
        "dashboard.add_today_menu": "Add Today's Menu",
        "dashboard.add_today_menu_description": "Manage dishes for a selected day in catering panel.",
        "dashboard.supported_locations": "Supported Locations",
        "dashboard.supported_locations_description": "Manage company locations and delivery addresses.",
        "dashboard.catering_orders": "Orders",
        "dashboard.catering_orders_description": "Review all user orders for a selected date.",
        "dashboard.total": "Total",
        "dashboard.company_billing": "Company Billing",
        "dashboard.billing_placeholder": "Billing summaries and payment details will be available here.",
        "menu.page_lead": "Browse today's available dishes and place your order.",
        "orders.page_lead": "Review your submitted order for today.",
        "order.page_title": "Place an Order",
        "order.page_lead": "Select quantities from today's menu and submit your order.",
        "order.form_aria": "Order form",
        "order.select_location": "Select location",
        "order.select_location_placeholder": "Select location",
        "order.error.location_required": "Please select a supported location.",
        "orders.selected_date": "Date",
        "billing.page_lead": "This section will include invoices and settlement details.",
        "order.updated": "Your order has been updated.",
        "error.invalid_credentials": "Invalid credentials",
        "error.invalid_role": "Invalid role selection.",
        "error.email_registered": "Email already registered.",
        "register.success": "Account created, you can sign in now.",
        "menu.title": "Manage Today's Menu",
        "menu.subtitle": "Create and manage today's menu items",
        "menu.select_date": "Select date",
        "menu.date": "Date",
        "menu.load_date": "Load menu",
        "menu.add_item": "Add menu item",
        "menu.name": "Name",
        "menu.description": "Description",
        "menu.price": "Price (PLN)",
        "menu.active": "Active",
        "menu.add_button": "Add item",
        "menu.items_for_day": "Today's menu items",
        "menu.status_active": "Active",
        "menu.status_inactive": "Inactive",
        "menu.disable": "Disable",
        "menu.enable": "Enable",
        "menu.empty": "No menu items for today.",
        "menu.success.created": "Menu item created.",
        "menu.error.forbidden": "You are not allowed to access catering menu.",
        "menu.error.name_required": "Name is required.",
        "menu.error.invalid_price": "Please provide a valid positive price.",
        "catering_orders.title": "Orders",
        "catering_orders.lead": "Review all submitted orders for the selected date.",
        "catering_orders.table_title": "Daily orders",
        "catering_orders.column_order_id": "Order ID",
        "catering_orders.column_user_email": "User email",
        "catering_orders.column_items": "Items",
        "catering_orders.column_total": "Total",
        "catering_orders.empty": "No orders for selected date.",
        "catering_orders.summary_title": "Summary by location",
        "catering_orders.summary_orders_count": "Orders",
        "catering_orders.summary_items_count": "Items",
        "catering_orders.summary_total": "Total",
        "settings.title": "Settings",
        "settings.user_roles": "User roles",
        "settings.column_id": "ID",
        "settings.column_email": "Email",
        "settings.column_role": "Role",
        "settings.column_action": "Action",
        "settings.save": "Save",
        "settings.success.role_updated": "User role updated.",
        "settings.error.forbidden": "You are not allowed to access settings.",
        "settings.error.invalid_role": "Invalid role selection.",
        "settings.error.user_not_found": "User not found.",
        "settings.dev.admin_exists": "Admin user already exists.",
        "settings.dev.promoted": "User promoted to admin.",
        "locations.title": "Supported Locations",
        "locations.lead": "Manage company locations and delivery addresses.",
        "locations.add_form_title": "Add location",
        "locations.company_name": "Company name",
        "locations.address": "Address",
        "locations.delivery_hours": "Default delivery hours (optional)",
        "locations.delivery_start": "Start time",
        "locations.delivery_end": "End time",
        "locations.active": "Active",
        "locations.add_button": "Add location",
        "locations.list_title": "Supported locations",
        "locations.hours_not_set": "Not set",
        "locations.status": "Status",
        "locations.empty": "No locations created yet.",
        "locations.success.created": "Location created.",
        "locations.error.required_fields": "Company name and address are required.",
        "locations.error.invalid_time": "Invalid delivery time format.",
    },
    "pl": {
        "nav.home": "Strona główna",
        "nav.login": "Zaloguj się",
        "nav.register": "Rejestracja",
        "nav.app": "Panel",
        "nav.catering": "Catering",
        "nav.settings": "Ustawienia",
        "index.eyebrow": "Platforma zamawiania posiłków",
        "index.lead": "Proste i mobilne zamawianie posiłków dla pracowników i firm.",
        "index.login": "Zaloguj się",
        "index.docs": "Dokumentacja API",
        "login.title": "Logowanie",
        "login.lead": "Użyj konta, aby przejść do panelu.",
        "login.email": "E-mail",
        "login.password": "Hasło",
        "login.submit": "Zaloguj się",
        "login.create_account": "Utwórz konto",
        "back.home": "Wróć do strony głównej",
        "register.title": "Utwórz konto",
        "register.lead": "Utwórz nowe konto, aby korzystać z panelu zamówień.",
        "register.role": "Rola",
        "register.submit": "Utwórz konto",
        "back.login": "Wróć do logowania",
        "role.employee": "Pracownik",
        "role.company": "Firma",
        "role.catering": "Catering",
        "role.admin": "Administrator",
        "dashboard.title": "Panel",
        "dashboard.lead": "Złóż dzisiejsze zamówienie i sprawdź bieżący wybór.",
        "dashboard.user_actions_label": "Akcje użytkownika",
        "dashboard.today_menu": "Dzisiejsze menu",
        "dashboard.place_order_tile": "Złóż zamówienie",
        "dashboard.place_order_description": "Wybierz ilości z dzisiejszego menu i wyślij zamówienie.",
        "dashboard.no_menu": "Brak pozycji w menu na dziś.",
        "dashboard.quantity": "Ilość",
        "dashboard.place_order": "Złóż zamówienie",
        "dashboard.my_orders": "Moje zamówienia",
        "dashboard.card_orders_description": "Sprawdź podsumowanie zamówienia dla wybranego dnia.",
        "dashboard.no_orders": "Nie masz zamówienia na dziś.",
        "dashboard.card_menu_description": "Przeglądaj dzisiejsze dania i złóż zamówienie.",
        "dashboard.admin_tools": "Narzędzia administratora",
        "dashboard.add_today_menu": "Dodaj menu na dziś",
        "dashboard.add_today_menu_description": "Zarządzaj daniami dla wybranego dnia w panelu cateringu.",
        "dashboard.supported_locations": "Lista obsługiwanych lokalizacji",
        "dashboard.supported_locations_description": "Zarządzaj firmami i adresami dostawy.",
        "dashboard.catering_orders": "Zamówienia",
        "dashboard.catering_orders_description": "Przeglądaj wszystkie zamówienia użytkowników dla wybranej daty.",
        "dashboard.total": "Suma",
        "dashboard.company_billing": "Rozliczenia firmy",
        "dashboard.billing_placeholder": "Podsumowania rozliczeń i szczegóły płatności będą dostępne tutaj.",
        "menu.page_lead": "Przeglądaj dzisiejsze dostępne dania i złóż zamówienie.",
        "orders.page_lead": "Sprawdź złożone zamówienie na dziś.",
        "order.page_title": "Złóż zamówienie",
        "order.page_lead": "Wybierz ilości z dzisiejszego menu i wyślij zamówienie.",
        "order.form_aria": "Formularz zamówienia",
        "order.select_location": "Wybierz lokalizację",
        "order.select_location_placeholder": "Wybierz lokalizację",
        "order.error.location_required": "Wybierz obsługiwaną lokalizację.",
        "orders.selected_date": "Data",
        "billing.page_lead": "W tej sekcji pojawią się faktury i szczegóły rozliczeń.",
        "order.updated": "Twoje zamówienie zostało zaktualizowane.",
        "error.invalid_credentials": "Nieprawidłowe dane logowania",
        "error.invalid_role": "Nieprawidłowa rola.",
        "error.email_registered": "E-mail jest już zarejestrowany.",
        "register.success": "Konto utworzone, możesz się zalogować.",
        "menu.title": "Zarządzanie menu na dziś",
        "menu.subtitle": "Twórz i zarządzaj dzisiejszymi pozycjami menu",
        "menu.select_date": "Wybierz datę",
        "menu.date": "Data",
        "menu.load_date": "Wczytaj menu",
        "menu.add_item": "Dodaj pozycję menu",
        "menu.name": "Nazwa",
        "menu.description": "Opis",
        "menu.price": "Cena (PLN)",
        "menu.active": "Aktywna",
        "menu.add_button": "Dodaj pozycję",
        "menu.items_for_day": "Dzisiejsze pozycje menu",
        "menu.status_active": "Aktywna",
        "menu.status_inactive": "Nieaktywna",
        "menu.disable": "Wyłącz",
        "menu.enable": "Włącz",
        "menu.empty": "Brak pozycji menu na dziś.",
        "menu.success.created": "Pozycja menu została utworzona.",
        "menu.error.forbidden": "Nie masz dostępu do menu cateringu.",
        "menu.error.name_required": "Nazwa jest wymagana.",
        "menu.error.invalid_price": "Podaj poprawną dodatnią cenę.",
        "catering_orders.title": "Zamówienia",
        "catering_orders.lead": "Przeglądaj wszystkie złożone zamówienia dla wybranej daty.",
        "catering_orders.table_title": "Zamówienia dzienne",
        "catering_orders.column_order_id": "ID zamówienia",
        "catering_orders.column_user_email": "E-mail użytkownika",
        "catering_orders.column_items": "Liczba pozycji",
        "catering_orders.column_total": "Suma",
        "catering_orders.empty": "Brak zamówień dla wybranej daty.",
        "catering_orders.summary_title": "Podsumowanie wg lokalizacji",
        "catering_orders.summary_orders_count": "Liczba zamówień",
        "catering_orders.summary_items_count": "Liczba pozycji",
        "catering_orders.summary_total": "Suma",
        "settings.title": "Ustawienia",
        "settings.user_roles": "Role użytkowników",
        "settings.column_id": "ID",
        "settings.column_email": "E-mail",
        "settings.column_role": "Rola",
        "settings.column_action": "Akcja",
        "settings.save": "Zapisz",
        "settings.success.role_updated": "Rola użytkownika została zaktualizowana.",
        "settings.error.forbidden": "Nie masz dostępu do ustawień.",
        "settings.error.invalid_role": "Nieprawidłowa rola.",
        "settings.error.user_not_found": "Nie znaleziono użytkownika.",
        "settings.dev.admin_exists": "Użytkownik administrator już istnieje.",
        "settings.dev.promoted": "Użytkownik został awansowany na administratora.",
        "locations.title": "Lista obsługiwanych lokalizacji",
        "locations.lead": "Zarządzaj firmami i adresami dostawy.",
        "locations.add_form_title": "Dodaj lokalizację",
        "locations.company_name": "Nazwa firmy",
        "locations.address": "Adres",
        "locations.delivery_hours": "Standardowe godziny dostawy (opcjonalne)",
        "locations.delivery_start": "Godzina od",
        "locations.delivery_end": "Godzina do",
        "locations.active": "Aktywna",
        "locations.add_button": "Dodaj lokalizację",
        "locations.list_title": "Obsługiwane lokalizacje",
        "locations.hours_not_set": "Nie ustawiono",
        "locations.status": "Status",
        "locations.empty": "Brak zdefiniowanych lokalizacji.",
        "locations.success.created": "Lokalizacja została dodana.",
        "locations.error.required_fields": "Nazwa firmy i adres są wymagane.",
        "locations.error.invalid_time": "Nieprawidłowy format godzin dostawy.",
    },
}


def get_language(request: Request) -> str:
    """Resolve language code from cookie, fallback to default language."""
    lang: str = request.cookies.get("lang", DEFAULT_LANGUAGE)
    if lang not in SUPPORTED_LANGUAGES:
        return DEFAULT_LANGUAGE
    return lang


def t(key: str, lang: str) -> str:
    """Translate key for a specific language with safe fallback."""
    normalized_lang: str = lang if lang in SUPPORTED_LANGUAGES else DEFAULT_LANGUAGE
    return TRANSLATIONS.get(normalized_lang, {}).get(key, key)
